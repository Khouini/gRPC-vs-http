# gRPC vs HTTP - Go Implementation

Simple demonstration of gRPC vs HTTP performance using Go with clean package structure.

## Project Structure

```
go/
├── cmd/
│   ├── gateway/           # HTTP gateway service
│   │   └── main.go
│   └── microservice/      # gRPC microservice
│       └── main.go
├── internal/
│   └── types/             # Shared data types
│       └── types.go
├── proto/                 # Generated protobuf files
│   ├── data.pb.go
│   └── data_grpc.pb.go
├── bin/                   # Compiled binaries
├── data.proto             # Protocol buffer definition
├── go.mod                 # Go module
├── Makefile              # Build automation
└── README.md
```

## Architecture

- **Microservice**: gRPC server (port 50051) that loads and serves user data
- **Gateway**: HTTP server (port 8080) using Gin that calls the microservice via gRPC
- **Types**: Shared data structures used across services
- **Data**: JSON file with user data (generated by the fake data generator)

## Setup

### Prerequisites
- Go 1.21+
- Protocol Buffers compiler (`protoc`)
- `protoc-gen-go` and `protoc-gen-go-grpc` plugins

Install protoc plugins:
```bash
go install google.golang.org/protobuf/cmd/protoc-gen-go@latest
go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest
```

### Quick Setup
```bash
make setup    # Generate proto files and install dependencies
```

## Running

### Start the microservice (Terminal 1):
```bash
make run-micro
# or
cd cmd/microservice && go run main.go
```

### Start the gateway (Terminal 2):
```bash
make run-gateway  
# or
cd cmd/gateway && go run main.go
```

### Build binaries:
```bash
make build
./bin/microservice    # Terminal 1
./bin/gateway         # Terminal 2
```

### Test the API:
```bash
make test
# or
curl http://localhost:8080/stats
```

## API Response

The gateway processes the gRPC data and returns:
```json
{
  "totalUsers": 9532,
  "activeUsers": 4766,
  "inactiveUsers": 4766,
  "dataSize": 0.86,
  "processTimeMs": 12
}
```

## Package Structure

- `cmd/microservice`: gRPC server application
- `cmd/gateway`: HTTP gateway application  
- `internal/types`: Shared data types and structures
- `proto/`: Generated protobuf Go files

## Performance

- **Data loading**: Once at startup (not per request)
- **gRPC communication**: Binary protocol, efficient serialization
- **Processing**: Simple counting logic in the gateway
- **Response time**: Includes gRPC call + data processing time
